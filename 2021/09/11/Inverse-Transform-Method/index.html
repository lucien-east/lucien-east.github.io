<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"lucien-east.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="Sometimes, we may wanna simulate certain random variable to get the desired approximation. Yet, if the scenario is rather complicated, the computation cost can be exorbitant. With the help of inverse">
<meta property="og:type" content="article">
<meta property="og:title" content="Sampling - Inverse Transformation Method">
<meta property="og:url" content="https://lucien-east.github.io/2021/09/11/Inverse-Transform-Method/index.html">
<meta property="og:site_name" content="East TechNote">
<meta property="og:description" content="Sometimes, we may wanna simulate certain random variable to get the desired approximation. Yet, if the scenario is rather complicated, the computation cost can be exorbitant. With the help of inverse">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://lucien-east.github.io/2021/09/11/Inverse-Transform-Method/geomtric_sim.png">
<meta property="og:image" content="https://lucien-east.github.io/2021/09/11/Inverse-Transform-Method/geomtric_sim_with_inv.png">
<meta property="article:published_time" content="2021-09-11T06:26:16.000Z">
<meta property="article:modified_time" content="2022-09-12T17:33:39.086Z">
<meta property="article:author" content="East">
<meta property="article:tag" content="Simulation">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="Sampling">
<meta property="article:tag" content="Inverse Transformation Method">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://lucien-east.github.io/2021/09/11/Inverse-Transform-Method/geomtric_sim.png">

<link rel="canonical" href="https://lucien-east.github.io/2021/09/11/Inverse-Transform-Method/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Sampling - Inverse Transformation Method | East TechNote</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">East TechNote</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Perhaps it's all about Math</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://lucien-east.github.io/2021/09/11/Inverse-Transform-Method/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="East">
      <meta itemprop="description" content="Let the light settle your heart">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="East TechNote">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Sampling - Inverse Transformation Method
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-09-11 14:26:16" itemprop="dateCreated datePublished" datetime="2021-09-11T14:26:16+08:00">2021-09-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-09-13 01:33:39" itemprop="dateModified" datetime="2022-09-13T01:33:39+08:00">2022-09-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Mathematics/" itemprop="url" rel="index"><span itemprop="name">Mathematics</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Mathematics/Probability-and-Statistics/" itemprop="url" rel="index"><span itemprop="name">Probability and Statistics</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>Sometimes, we may wanna simulate certain random variable to get the
desired approximation. Yet, if the scenario is rather complicated, the
computation cost can be exorbitant. With the help of <strong>inverse
transformation method</strong>, we are able to generate many special
random variables efficienctly.</p>
<span id="more"></span>
<h2 id="a-toy-example">A Toy Example</h2>
<blockquote>
<p>With replacement, we draw cards at random from an ordinary deck of 52
cards, and successively until an ACE is drawn. What is the probability
of exactly 10 draws?</p>
</blockquote>
<p>Apparently, let <span class="math inline">\(X\)</span> be the number
of draws until the first ace. The random variable <span
class="math inline">\(X\)</span> is of <strong>geometric
distribution</strong> with the parameter <span class="math inline">\(p =
\frac{1}{13}\)</span>. The answer of the desired probability is</p>
<p><span class="math display">\[
P(x) = (1-p)^{x-1} * p = (\frac{12}{13})^9 * (\frac{1}{13})
\]</span></p>
<h2 id="simulating-x">Simulating <span
class="math inline">\(X\)</span></h2>
<p>Now, if we wanna approximate the desired probability by simulating
<span class="math inline">\(X\)</span>, an intuitive way might look like
as below:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### Pseudo-code of Simulation</span></span><br><span class="line"></span><br><span class="line">i = <span class="number">0</span>    <span class="comment"># iterator</span></span><br><span class="line">k = <span class="number">0</span>    <span class="comment"># Record the desired events</span></span><br><span class="line"><span class="keyword">while</span> i &lt; N:      <span class="comment"># Repeat N trials</span></span><br><span class="line">    draws = <span class="number">0</span>     <span class="comment"># Count how many draws when the first ACE appears</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:   <span class="comment"># Draw the card with replacement until it is an ACE</span></span><br><span class="line">        draws +=<span class="number">1</span></span><br><span class="line">        Generate a random sample x <span class="keyword">from</span> [A,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,..<span class="number">.9</span>,<span class="number">10</span>,J,Q,K]</span><br><span class="line">        <span class="keyword">if</span> x <span class="keyword">is</span> ACE:   <span class="comment"># Let 1 represent the ACE</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> draws <span class="keyword">is</span> <span class="number">10</span>:  <span class="comment"># Number of draws is exactly 10</span></span><br><span class="line">        k +=<span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    i +=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">prob = k/N   <span class="comment"># The approximate value</span></span><br></pre></td></tr></table></figure>
<p>From the experiment, it can be observed that <span
class="math inline">\(N\)</span> has to be quite large (&gt;10000) if we
would like to get enough accuracy:</p>
<img src="/2021/09/11/Inverse-Transform-Method/geomtric_sim.png" class="" title="This is an image">
<p>Below is the source code:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># N trials</span></span><br><span class="line"><span class="comment"># k: Count the desired events obtained in N trials</span></span><br><span class="line"></span><br><span class="line">N = [<span class="number">100</span>, <span class="number">250</span>, <span class="number">500</span>, <span class="number">750</span>, </span><br><span class="line">     <span class="number">1000</span>, <span class="number">1500</span>, <span class="number">2000</span>, <span class="number">2500</span>, <span class="number">3000</span>, <span class="number">3500</span>, <span class="number">4000</span>, <span class="number">4500</span>, <span class="number">5000</span>,</span><br><span class="line">     <span class="number">5500</span>, <span class="number">6000</span>, <span class="number">6500</span>, <span class="number">7000</span>, <span class="number">7500</span>, <span class="number">8000</span>, <span class="number">8500</span>, <span class="number">9000</span>, <span class="number">9500</span>,</span><br><span class="line">     <span class="number">10000</span>, <span class="number">12500</span>, <span class="number">15000</span>, <span class="number">17500</span>, <span class="number">20000</span>]</span><br><span class="line">approx = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> N:</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    k = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i &lt; n:</span><br><span class="line">        <span class="comment"># draw the card with replacement until it is ACE</span></span><br><span class="line">        j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            j +=<span class="number">1</span></span><br><span class="line">            draw = np.random.randint(<span class="number">1</span>, <span class="number">13</span>)</span><br><span class="line">            <span class="keyword">if</span> draw == <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> j == <span class="number">10</span>:  <span class="comment"># draw number is 10</span></span><br><span class="line">            k +=<span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        i +=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">    approx.append(k/n)</span><br><span class="line"></span><br><span class="line">ans = (<span class="number">12</span>/<span class="number">13</span>)**<span class="number">9</span> * (<span class="number">1</span>/<span class="number">13</span>)</span><br><span class="line"></span><br><span class="line">plt.scatter(x=N, y=approx)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;Number of trials&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;Approximate probability&#x27;</span>)</span><br><span class="line">plt.axhline(y=ans, color=<span class="string">&#x27;r&#x27;</span>, linestyle=<span class="string">&#x27;-&#x27;</span>, label=<span class="string">&#x27;Answer&#x27;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.title(<span class="string">&#x27;Simulation to get the Ace at exactly 10 draws&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>However, this approach is not efficient because the time complexity
is proportional to the draw number. Thus, let's introduce the inverse
transformation method. By this method, we are able to get the same
result as well but only need to choose one random point in (0,1),
significantly reducing the time cost.</p>
<h2 id="inverse-transformation-method">Inverse Transformation
Method</h2>
<p>Let <span class="math inline">\(F(X) = P(X \leq x)\)</span> be the
probability distribution function of the random variable <span
class="math inline">\(X\)</span>. Remember that for uniform random
variable <span class="math inline">\(U\)</span> over <span
class="math inline">\((0,1)\)</span>,</p>
<p><span class="math display">\[
F(U) = P(U \leq x) = x, x \in (0,1) \tag{1}
\]</span></p>
<p>Imagine that our objective is to simulate a random variable <span
class="math inline">\(X\)</span> from a uniform random variable <span
class="math inline">\(U\)</span>, i.e., <span class="math inline">\(P(X
\leq x) = P(T(U) \leq x)\)</span>. We hope to find a transformation
<span class="math inline">\(T\)</span> that is able to convert the
random variable <span class="math inline">\(U\)</span> into our desired
<span class="math inline">\(X\)</span>.</p>

$$
\displaylines {
P(X \leq x) \\
= P(T(U) \leq x) \\
= P(U \leq T^{-1}(x)) \\
}
$$

<p>Remember that <span class="math inline">\(F(X) = P(X \leq x)\)</span>
and from <span class="math inline">\((1)\)</span>:</p>

$$
\displaylines {
P(U \leq T^{-1}(x)) \\
= P(U \leq F(x)) \\
= P(F^{-1}(U) \leq x)
}
$$

<p><span class="math display">\[
\longrightarrow X = F^{-1}(U) \tag{2}
\]</span></p>
<p>From <span class="math inline">\((2)\)</span>, we know the
transformation <span class="math inline">\(T\)</span> we are looking for
is just <span class="math inline">\(F^{-1}\)</span>. Therefore, after
solving <span class="math inline">\(F^{-1}\)</span>, we are able to
generate the desired <span class="math inline">\(X\)</span> from uniform
random variable <span class="math inline">\(U\)</span> directly without
complications.<a href="#fn1" class="footnote-ref" id="fnref1"
role="doc-noteref"><sup>1</sup></a></p>
<h2
id="simulating-geometric-distribution-via-inverse-transformation-method">Simulating
Geometric Distribution via Inverse Transformation Method</h2>
<p>Back to our original problem, we wanna simulate <span
class="math inline">\(X\)</span> in the toy example, and we know that
the <span class="math inline">\(F(x)\)</span> of geometric distribution
with parameter <span class="math inline">\(p\)</span> is</p>
<p><span class="math display">\[
F(x) = 1 - (1-p)^{x-1}
\]</span></p>
<p>Solve <span class="math inline">\(u = F(x)\)</span>:</p>

$$
\displaylines {
u = 1 - (1-p)^{x-1} \\
x = 1 + \frac{\log{(1-u)}}{\log{(1-p)}}
}
$$

<p><span class="math display">\[
\equiv 1 + \frac{\log{u}}{\log{(1-p)}}  \tag{3}
\]</span></p>
<p>If <span class="math inline">\(u\)</span> is a random number variable
from (0,1), then <span class="math inline">\((1-u)\)</span> is a random
number variable from (0,1) as well.</p>
<p>Now, from <span class="math inline">\((3)\)</span>, we are able to
generate <span class="math inline">\(X\)</span> from <span
class="math inline">\(U\)</span> efficiently. Because <span
class="math inline">\(X\)</span> is an integer, we use the <em>floor
operation</em> (with the <em>ceiling</em> is also equivalent):</p>
<p><span class="math display">\[
X = \lfloor 1 + \frac{\log{u}}{\log{(1-p)}} \rfloor
\]</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### Pseudo-code of Geometric Distribution Simulation with Inverse Transform method</span></span><br><span class="line"></span><br><span class="line">i = <span class="number">0</span>    <span class="comment"># iterator</span></span><br><span class="line">k = <span class="number">0</span>    <span class="comment"># Record the desired events</span></span><br><span class="line"><span class="keyword">while</span> i &lt; N:      <span class="comment"># Repeat N trials</span></span><br><span class="line">    Generate a uniform random variable u <span class="keyword">from</span> (<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line">    <span class="comment"># p is the parameter of geometric distribution</span></span><br><span class="line">    X = floor(<span class="number">1</span> + log(u)/log(<span class="number">1</span>-p))   <span class="comment"># inverse transform</span></span><br><span class="line">    <span class="keyword">if</span> X <span class="keyword">is</span> <span class="number">10</span>:</span><br><span class="line">        k +=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">    i +=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">prob = k/N   <span class="comment"># The approximate value</span></span><br></pre></td></tr></table></figure>
<p>Below is the experimental result and the related source code:</p>
<img src="/2021/09/11/Inverse-Transform-Method/geomtric_sim_with_inv.png" class="" title="This is an image">
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> log, floor</span><br><span class="line"></span><br><span class="line"><span class="comment"># N trials</span></span><br><span class="line"><span class="comment"># k: Count the desired events obtained in N trials</span></span><br><span class="line"></span><br><span class="line">N = [<span class="number">100</span>, <span class="number">250</span>, <span class="number">500</span>, <span class="number">750</span>, </span><br><span class="line">     <span class="number">1000</span>, <span class="number">1500</span>, <span class="number">2000</span>, <span class="number">2500</span>, <span class="number">3000</span>, <span class="number">3500</span>, <span class="number">4000</span>, <span class="number">4500</span>, <span class="number">5000</span>,</span><br><span class="line">     <span class="number">5500</span>, <span class="number">6000</span>, <span class="number">6500</span>, <span class="number">7000</span>, <span class="number">7500</span>, <span class="number">8000</span>, <span class="number">8500</span>, <span class="number">9000</span>, <span class="number">9500</span>,</span><br><span class="line">     <span class="number">10000</span>, <span class="number">12500</span>, <span class="number">15000</span>, <span class="number">17500</span>, <span class="number">20000</span>]</span><br><span class="line">approx = []</span><br><span class="line">p = <span class="number">1</span>/<span class="number">13</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> N:</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    k = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i &lt; n:</span><br><span class="line">        <span class="comment"># inverse transformation method</span></span><br><span class="line">        u = np.random.rand()</span><br><span class="line">        X = floor(<span class="number">1</span> + log(u)/log(<span class="number">1</span>-p))</span><br><span class="line">        <span class="keyword">if</span> X == <span class="number">10</span>:</span><br><span class="line">            k +=<span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        i +=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">    approx.append(k/n)</span><br><span class="line"></span><br><span class="line">ans = (<span class="number">12</span>/<span class="number">13</span>)**<span class="number">9</span> * (<span class="number">1</span>/<span class="number">13</span>)</span><br><span class="line"></span><br><span class="line">plt.scatter(x=N, y=approx)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;Number of trials&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;Approximate probability&#x27;</span>)</span><br><span class="line">plt.axhline(y=ans, color=<span class="string">&#x27;r&#x27;</span>, linestyle=<span class="string">&#x27;-&#x27;</span>, label=<span class="string">&#x27;Answer&#x27;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.title(<span class="string">&#x27;Simulation with Inverse Tranformation Method&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<h2 id="performance-comparison">Performance Comparison</h2>
<p>Let N be 500000 trials.</p>
<p>Original method:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### Original Method</span></span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> perf_counter</span><br><span class="line"></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">k = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">t1_start = perf_counter()</span><br><span class="line"><span class="keyword">while</span> i &lt; <span class="number">500000</span>:</span><br><span class="line">    <span class="comment"># draw the card with replacement until it is ACE</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        j +=<span class="number">1</span></span><br><span class="line">        draw = np.random.randint(<span class="number">1</span>, <span class="number">13</span>)</span><br><span class="line">        <span class="keyword">if</span> draw == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> j == <span class="number">10</span>:  <span class="comment"># draw number is 10</span></span><br><span class="line">        k +=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">    i +=<span class="number">1</span></span><br><span class="line">t1_stop = perf_counter()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Elapsed time (sec):&quot;</span>, t1_stop-t1_start) </span><br></pre></td></tr></table></figure>
<p>Inverse transformation method:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> perf_counter</span><br><span class="line"></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">k = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">t1_start = perf_counter()  </span><br><span class="line"><span class="keyword">while</span> i &lt; <span class="number">500000</span>:</span><br><span class="line">    <span class="comment"># inverse transformation method</span></span><br><span class="line">    u = np.random.rand()</span><br><span class="line">    X = floor(<span class="number">1</span> + log(u)/log(<span class="number">1</span>-p))</span><br><span class="line">    <span class="keyword">if</span> X == <span class="number">10</span>:</span><br><span class="line">        k +=<span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    i +=<span class="number">1</span></span><br><span class="line">t1_stop = perf_counter()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Elapsed time (sec):&quot;</span>, t1_stop-t1_start) </span><br></pre></td></tr></table></figure>
<p>Results:</p>
<table>
<thead>
<tr class="header">
<th>N = 500000 (trials)</th>
<th>Elapsed Time (sec)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Original Method</td>
<td>10.832</td>
</tr>
<tr class="even">
<td>Inverse Transformation Method</td>
<td>0.363</td>
</tr>
</tbody>
</table>
<p>We can observe that the elapsed time has been substantially reduced
after applying inverse transformation method.</p>
<blockquote>
<p>Note that the inverse transformation method is to mainly improve the
computation cost. It does <strong>not</strong> increase the convergence
rate. From the previous experimental results, you can see that the N
trials required to converge are roughly the same for both methods.</p>
</blockquote>
<section id="footnotes" class="footnotes footnotes-end-of-document"
role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p>For rigorous proof, you can refer to <a
target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Inverse_transform_sampling">Inverse
transform sampling</a>. The aim here is to grasp the idea intuitively.<a
href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Simulation/" rel="tag"># Simulation</a>
              <a href="/tags/Python/" rel="tag"># Python</a>
              <a href="/tags/Sampling/" rel="tag"># Sampling</a>
              <a href="/tags/Inverse-Transformation-Method/" rel="tag"># Inverse Transformation Method</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/08/07/cpp-smart-pointers/" rel="prev" title="[C++] Smart Pointers - unique_ptr, shared_ptr, weak_ptr - from the implementation to their usage">
      <i class="fa fa-chevron-left"></i> [C++] Smart Pointers - unique_ptr, shared_ptr, weak_ptr - from the implementation to their usage
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/07/30/Implement-SVM-with-SMO-from-scratch/" rel="next" title="Implement SVM with SMO from scratch in Python">
      Implement SVM with SMO from scratch in Python <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#a-toy-example"><span class="nav-number">1.</span> <span class="nav-text">A Toy Example</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#simulating-x"><span class="nav-number">2.</span> <span class="nav-text">Simulating \(X\)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#inverse-transformation-method"><span class="nav-number">3.</span> <span class="nav-text">Inverse Transformation
Method</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#simulating-geometric-distribution-via-inverse-transformation-method"><span class="nav-number">4.</span> <span class="nav-text">Simulating
Geometric Distribution via Inverse Transformation Method</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#performance-comparison"><span class="nav-number">5.</span> <span class="nav-text">Performance Comparison</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">East</p>
  <div class="site-description" itemprop="description">Let the light settle your heart</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">8</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="mailto:lucien.omni@gmail.com" title="E-Mail → mailto:lucien.omni@gmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">East</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
